<!DOCTYPE html>
<html >
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Vertical Timeline</title>
  <link href="https://fonts.googleapis.com/css?family=Roboto:100i,300,400,500,700" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Allura" rel="stylesheet">

  <link rel='stylesheet prefetch' href='https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css'>

      <link rel="stylesheet" href="css/timeline.css">

      <style>
      .list-group-item {
      background-color: transparent;
      border: 0px solid #ddd;
      border-radius: 0;
      }
      /* two scroll bar problem */
      html {
        overflow-x: initial !important;
      }
      </style>
      <!-- script starts here -->
      <script type="text/javascript" src="https://code.jquery.com/jquery-1.7.1.min.js"></script>
    	<!-- <script src="//cdnjs.cloudflare.com/ajax/libs/seedrandom/3.0.5/seedrandom.min.js"> -->
    	</script>
    	<script type="text/javascript"  src="tOS2.0.21/core/shuffle.js" ></script>
    	<script type="text/javascript"  src="tOS2.0.21/core/date.js" ></script>
    	<script type="text/javascript"  src="tOS2.0.21/core/load_meeting_info.js" ></script>
    	<!-- <script type="text/javascript"  src="js/growth.js" ></script> -->
    	<script type="text/javascript">
    	// var URL_SIGNUPSHEET = "https://spreadsheets.google.com/feeds/cells/17Vtxbeh7Q6-ic89sWC8_U8RUoUAr6dlvi3jxADRMNQU/2/public/full?alt=json";
    	// var URL_TOASTIESSHEET = "https://spreadsheets.google.com/feeds/cells/1E9VdBM1YSS0ykQG-U8yAopu8a2c9_G9U66DG_pmBmw4/1/public/full?alt=json";
    // old api is inconvenient because it skips empty cells and don't allow accessing via sheetname (sheet index is needed, so we put the sheet always the second sheets)
    // getData(row, col) {
    // 	let entry = this.entry;
    // 	row = '' + row // to string
    // 	col = '' + col
    // 	for (let i = 0; i < entry.length; i++) {
    // 		if(entry[i].gs$cell.row == row && entry[i].gs$cell.col == col) {
    // 			return  entry[i].content.$t;
    // 		}
    // 	}
    // }
    var signupSheet;
    var toastiesSheet;
    var toastiesPoints;
    var member = getUrlVars()["member"]; //'Zoe'; //"Shaheer"; // 'Zoe'; // getUrlVars()["member"]
    var today = new Date();
    today = today.getDateWithoutTime()
    console.warn(`today: ${today}`)

    	$(document).ready(function() {
    		var SIGNUPSHEET_ID = '17Vtxbeh7Q6-ic89sWC8_U8RUoUAr6dlvi3jxADRMNQU';
    		var TOASTIESSHEET_ID = '1E9VdBM1YSS0ykQG-U8yAopu8a2c9_G9U66DG_pmBmw4';
    		toastiesSheet = new ToastiesSheet(TOASTIESSHEET_ID, "2021");

    		var sheetname = SignupSheet.getMeetingSheetName(today);
    		console.log(`sheetname: ${sheetname}`)
    		signupSheet = new SignupSheet(SIGNUPSHEET_ID, encodeURIComponent(sheetname)); // "Aug+%2721-Sept+%2721"
    	  // wait for all sheets are loaded
    		// first prepare listener
    		console.log("document is ready")
    	  var members_loaded = new Promise(function(resolve) {
    	      document.addEventListener("loaded_ToastiesSheet",resolve,false);
    	  })
    	  var roles_loaded = new Promise(function(resolve) {
    	      document.addEventListener("loaded_SignupSheet", resolve, false);
    	  })
    	  Promise.all([members_loaded, roles_loaded]).then(function() {
    	      // after getting meeting col
    				// In the javascript world months begin with zero! kind of weird to me. Anyhow, 9 is NOT September, but rather 9 is October.
    				toastiesSheet.members = toastiesSheet.listMembers();
            $("#membername").html(toastiesSheet.members[member]['full_name']);
    				console.log(`today: ${today}`)
    				signupSheet.meetingCol = signupSheet.getMeetingCol(today);
    				console.log(`today: ${today}`)
    				signupSheet.members = toastiesSheet.members;
    				signupSheet.roles = signupSheet.getColumn(signupSheet.meetingCol);

            // first, only compute points for today
            // scan this person, if in role, get points
    				// console.warn(signupSheet.roles)
    				// console.log(toastiesSheet.members)
    				// console.log(signupSheet.meetingCol)
            toastiesPoints = signupSheet.getToastyPoints(member);
    	  });
    	});
    	</script>

      <!-- script ends here -->

</head>

<body>
  <header>
    <div class="container text-center">
      <h1>Toasty Timeline</h1>
      <p id="membername"></p>
      <h6 id="member_score"></h6>
      <a href="/leaderboard.html" style='background-color:#FF4081'>
        <!-- https://icons.getbootstrap.com/icons/trophy/ -->
        <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trophy" viewBox="0 0 16 16">
          <path d="M2.5.5A.5.5 0 0 1 3 0h10a.5.5 0 0 1 .5.5c0 .538-.012 1.05-.034 1.536a3 3 0 1 1-1.133 5.89c-.79 1.865-1.878 2.777-2.833 3.011v2.173l1.425.356c.194.048.377.135.537.255L13.3 15.1a.5.5 0 0 1-.3.9H3a.5.5 0 0 1-.3-.9l1.838-1.379c.16-.12.343-.207.537-.255L6.5 13.11v-2.173c-.955-.234-2.043-1.146-2.833-3.012a3 3 0 1 1-1.132-5.89A33.076 33.076 0 0 1 2.5.5zm.099 2.54a2 2 0 0 0 .72 3.935c-.333-1.05-.588-2.346-.72-3.935zm10.083 3.935a2 2 0 0 0 .72-3.935c-.133 1.59-.388 2.885-.72 3.935zM3.504 1c.007.517.026 1.006.056 1.469.13 2.028.457 3.546.87 4.667C5.294 9.48 6.484 10 7 10a.5.5 0 0 1 .5.5v2.61a1 1 0 0 1-.757.97l-1.426.356a.5.5 0 0 0-.179.085L4.5 15h7l-.638-.479a.501.501 0 0 0-.18-.085l-1.425-.356a1 1 0 0 1-.757-.97V10.5A.5.5 0 0 1 9 10c.516 0 1.706-.52 2.57-2.864.413-1.12.74-2.64.87-4.667.03-.463.049-.952.056-1.469H3.504z"/>
        </svg>
      </a>
    </div>
  </header>

  <section class="timeline">

    <div class="container" id="boxtimeline">


      <!-- <div class="timeline-item">
        <div class="timeline-img"></div>

        <div class="timeline-content js--fadeInLeft">
          <h2>Title</h2>
       		<div class="date">1 MAY 2016</div>
          <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Maxime ipsa ratione omnis alias cupiditate saepe atque totam aperiam sed nulla voluptatem recusandae dolor, nostrum excepturi amet in dolores. Alias, ullam.</p>
          <a class="bnt-more" href="javascript:void(0)">More</a>
          <ul class="list-group">
            <li class="list-group-item d-flex justify-content-between align-items-center">
              Cras justo odio
              <span class="badge badge-primary badge-pill">+14</span>
            </li>
            <li class="list-group-item d-flex justify-content-between align-items-center">
              Dapibus ac facilisis in
              <span class="badge badge-primary badge-pill">+2</span>
            </li>
            <li class="list-group-item d-flex justify-content-between align-items-center">
              Morbi leo risus
              <span class="badge badge-primary badge-pill">+1</span>
            </li>
          </ul>
        </div>
      </div> -->

    </div>
  </section>
  <script src='https://code.jquery.com/jquery-2.2.4.min.js'></script>
<script src='https://cdn.jsdelivr.net/scrollreveal.js/3.3.1/scrollreveal.min.js'></script>

    <script src="js/index.js"></script>

</body>
</html>
